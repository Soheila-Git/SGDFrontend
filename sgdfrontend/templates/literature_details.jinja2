<!DOCTYPE html>

<title>{{display_name}} Literature</title>

{% extends "templates/global_layout.jinja2" %}


{% block body %}

<div id="center_title" class="row">
	<h2><span class="gene_name">{{display_name}}/{{format_name}}</span> Literature</h2>
</div>


<!-- Includes tabs.html into template -->
{% include "templates/tabs.jinja2" %}

<script>
	var lit_tab = document.getElementById('literature_tab');
	lit_tab.id = 'current';
</script>


<!-- Docs nav
================================================== -->
<div class="row">
	<nav id="sidebar" class="small-3 columns">
		<ul data-magellan-expedition="fixed" class="side-nav" id="side-nav-sticky">
			<li id="nav-title"><h5><a href="{{link}}">{{display_name}}/{{format_name}}</a> Literature</h5></li>
			<li data-magellan-arrival="primary"><a href="#primary">Primary Literature</a></li>
			<li data-magellan-arrival="network"><a href="#network">Network Visualization</a></li>
          	<li data-magellan-arrival="additional"><a href="#additional">Additional Literature</a></li>
          	<li data-magellan-arrival="reviews"><a href="#reviews">Reviews</a></li>
          	<li data-magellan-arrival="go"><a href="#go">Gene Ontology Literature</a></li>
          	<li data-magellan-arrival="phenotype"><a href="#phenotype">Phenotype Literature</a></li>
		</ul>
	</nav>
	
	<div class="small-9 columns">  

<!-- Primary
================================================== -->
<section id="primary" data-magellan-destination="primary">
	<div class="page-header">
		<h1>Primary Literature <span id="primary_header" class="label secondary rounded"></span></h1>
		<span id='primary_message' class="hide">No primary literature curated.</span>
		<div id='primary_wrapper'>	
			<a class="small button secondary" onclick="download_citations('primary_list', '{{download_link}}', '{{display_name}}_primary_citations')" >Export</a>	
			<ul id='primary_list'>
			</ul>
		</div>
	</div>
</section>

<!-- Network Visualization
================================================== -->
<section id="network" data-magellan-destination="network">
	<div class="page-header">
		<h1>Network Visualization</h1>
			<div class="panel">
				<div id="cy" name="cy" style="width:100%;height:700px"></div>
				<br>
				<span>Export:</span>
				<ul class="button-group radius">
					<li><a class="small button secondary" onclick="vis.exportNetwork('png', '/download_graph/png')">png</a></li>
					<li><a class="small button secondary" onclick="vis.exportNetwork('svg', '/download_graph/svg')">svg</a></li>
					<li><a class="small button secondary" onclick="vis.exportNetwork('pdf', '/download_graph/pdf')">pdf</a></li>
					<li><a class="small button secondary" onclick="vis.exportNetwork('xgmml', '/download_graph/xml')">xgmml</a></li>
					<li><a class="small button secondary" onclick="vis.exportNetwork('graphml', '/download_graph/txt')">graphml</a></li>
					<li><a class="small button secondary" onclick="vis.exportNetwork('sif', '/download_graph/txt', options={nodeAttr:'label', interactionAttr:'label'})">txt</a></li>
				</ul>
			</div><!-- .panel -->
    </div>
</section>

<!-- Additional
================================================== -->
<section id="additional" data-magellan-destination="additional">
	<div class="page-header">
		<h1>Additional Literature <span id="additional_header" class="label secondary rounded"></span></h1>
		<span id='additional_message' class="hide">No additional literature curated.</span>
		<div id='additional_wrapper'>
			<a class="small button secondary" onclick="download_citations('additional_list', '{{download_link}}', '{{display_name}}_additional_citations')">Export</a>						
			<ul id='additional_list'>
			</ul>
		</div>
	</div>
</section>

<!-- Review
================================================== -->
<section id="reviews" data-magellan-destination="reviews">
	<div class="page-header">
		<h1>Reviews <span id="review_header" class="label secondary rounded"></span></h1>
		<span id='review_message' class="hide">No reviews curated.</span>
		<div id='review_wrapper'>
			<a class="small button secondary" onclick="download_citations('review_list', '{{download_link}}', '{{display_name}}_review_citations')">Export</a>						
			<ul id='review_list'>
			</ul>
		</div>
	</div>
</section>

<!-- GO
================================================== -->
<section id="go" data-magellan-destination="go">
	<div class="page-header">
		<h1>Gene Ontology Literature <span id="go_header" class="label secondary rounded"></span></h1>
		<span id='go_message' class="hide">No gene ontology literature curated.</span>
		<div id='go_wrapper'>
			<a class="small button secondary" onclick="download_citations('go_list', '{{download_link}}', '{{display_name}}_go_citations')">Export</a>						
			<ul id='go_list'>
			</ul>
		</div>
	</div>
</section>

<!-- Phenotype
================================================== -->
<section id="phenotype" data-magellan-destination="phenotype">
	<div class="page-header">
		<h1>Phenotype Literature <span id="phenotype_header" class="label secondary rounded"></span></h1>
		<span id='phenotype_message' class="hide">No phenotype literature curated.</span>
		<div id='phenotype_wrapper'>	
			<a class="small button secondary" onclick="download_citations('phenotype_list', '{{download_link}}', '{{display_name}}_phenotype_citations')">Export</a>					
			<ul id='phenotype_list'>
			</ul>
		</div>
	</div>
</section>
<br>
<br>
<br>
<br>
<br>
<br>
</div>
</div>

{% endblock body %}

{% block scripts %}

<script src="/static/js/cytoscape/cytoscape.min.js"></script>	
<script src="/static/js/cytoscape/arbor.js"></script>	

<script>
	function set_up_primary_list(data) {	
		set_up_count(data.length, "primary_header");
  		set_up_references(data, "primary_list");
	}
	
	function set_up_additional_list(data) {
		set_up_count(data.length, "additional_header");
  		set_up_references(data, "additional_list");
	}
	
	function set_up_review_list(data) {		
		set_up_count(data.length, "review_header");
  		set_up_references(data, "review_list");
	}
		
	function set_up_go_list(data) {
		set_up_count(data.length, "go_header");
  		set_up_references(data, "go_list");
	}
		
	function set_up_phenotype_list(data) {
		set_up_count(data.length, "phenotype_header");
  		set_up_references(data, "phenotype_list");
	}
	
	$(document).ready(function() {
		//Get bioentevidence data
  		$.getJSON("{{bioent_evidence_table_link}}", function(data) {
  			set_up_primary_list(data['primary']);
  			set_up_additional_list(data['additional']);
  			set_up_review_list(data['reviews']);
  		});
  		
  		//Get go reference data
  		$.getJSON("{{go_references_link}}", set_up_go_list);
  		
  		//Get phenotype reference data
  		$.getJSON("{{phenotype_references_link}}", set_up_phenotype_list);
	});
</script>

<script>
var style = cytoscape.stylesheet()
	.selector('node')
	.css({
		'content': 'data(name)',
		'font-family': 'helvetica',
		'font-size': 14,
		'text-outline-width': 3,
		'text-outline-color': '#888',
		'text-valign': 'center',
		'color': '#fff',
		'width': 30,
		'height': 30,
		'border-color': '#fff'
	})
	.selector('edge')
	.css({
		'width': 2,
	})
	.selector("node[sub_type='FOCUS']")
	.css({
		'background-color': "#fade71",
		'text-outline-color': '#fff',
		'color': '#888',
	})
	.selector("node[type='REFERENCE']")
	.css({
		'background-color': "#D0A9F5",
		'shape': 'rectangle',
		'text-outline-color': '#fff',
		'color': '#888',
	});


$.getJSON("{{literature_graph_link}}", function(data) {
	var cy = setup_cytoscape_vis('cy', style, data);
});
</script>

{% endblock scripts %}

