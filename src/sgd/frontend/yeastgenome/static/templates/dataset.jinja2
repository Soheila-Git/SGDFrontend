{% extends "global_layout.jinja2" %}

{% block title %}{{ dataset.display_name }}{% endblock %}

{% block head %}
<script>
	var download_table_link = "{{download_table_link}}";
	var analyze_link = "{{analyze_table_link}}";

	var download_filename = "{{ dataset.format_name|replace(".", "_") }}_annotations";

    var display_name = "{{ dataset.display_name }}";
</script>
{% endblock %}


{% block body %}

<div id="center_title" class="row">
	<h1>Dataset: <span class="gene_name">{{ dataset.display_name }}</span></h1>
</div>

<!-- Navbar
================================================== -->
<div class="row">
	
<!-- Includes navbar.html into template -->
    {% include "navbar.jinja2" %}

    <div class="small-12 large-9 columns content-column">

        <script>
            add_navbar_title('Dataset: <span class="gene_name">{{ dataset.display_name }}</span>');
            add_navbar_element('Overview', 'overview');
            {%  if dataset.reference.abstract != none %}
                add_navbar_element('Abstract', 'abstract');
            {%  endif %}
            add_navbar_element('Conditions', 'conditions');
            {% if dataset.urls|length > 0 %}
                add_navbar_element('Resources', 'resources');
            {%  endif %}
        </script>

        <!-- Summary
        ================================================== -->
        <section id="overview" data-magellan-destination="overview">
            <div class="page-header">
                <h2>Overview</h2>
                <div class="panel">
                    <dl class="key-value">
                        {% if dataset.geo_id != None %}
                            <dt>GEO ID</dt>
                            <dd>
                                {% for url in dataset.urls if url.category == 'External' %}
                                   <a href="{{ url.link }}" target="_blank">{{ url.display_name }}</a>
                                {% endfor %}
                                {% if dataset.urls|length == 0 %}
                                   {{ dataset.geo_id }}
                                {% endif %}
                            </dd>
                        {% endif %}

                        <dt>Reference</dt>
                        <dd><a href="{{ dataset.reference.link }}">{{ dataset.reference.display_name }}</a></dd>

                        <dt>Channels</dt>
                        <dd>{{ dataset.channel_count }}</dd>

                        <dt>Conditions</dt>
                        <dd>{{ dataset.condition_count }}</dd>

                        <dt>Description</dt>
                        <dd>{{ dataset.short_description|safe }}</dd>

                        <dt>Categories</dt>
                        <dd>
                            {% for tag in dataset.tags %}
                                <a href="{{ tag.link }}">{{ tag.display_name }}</a>{% if not loop.last %}, {% endif %}
                            {% endfor %}
                        </dd>
                     </dl>
                </div>
            </div>
        </section>

            <!-- Abstract
================================================== -->
        {%  if dataset.reference.abstract != none %}
            <section id="abstract" data-magellan-destination="abstract">
                <div class="page-header">
                    <h2>Abstract</h2>
                    <div class="panel">
                        <p>{{ dataset.reference.abstract.text|safe}}</p>
                    </div>
                </div>
            </section>
        {%  endif %}

            <!-- Conditions
================================================== -->
        <section id="conditions" data-magellan-destination="conditions">
            <div class="page-header">
                <h2>Conditions</h2>
                <div class="panel">
                    <ul>
                        {% for condition in dataset.datasetcolumns %}
                            <li>{{ condition.display_name }}</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </section>

        <!-- Resources
================================================== -->
        {% if dataset.urls|length > 0 %}
            <section id="resources" data-magellan-destination="resources">
                <div class="page-header">
                    <h2>Resources</h2>
                    <div class="panel">
                        <p id='resource_list' class="unstyled">
                            {% for url in dataset.urls %}
                                <a href="{{ url.link }}" target="_blank">{{ url.display_name }}</a>{% if not loop.last %} | {% endif %}
                            {% endfor %}
                        </p>
                    </div>
                </div>
            </section>
        {% endif %}
    </div>
</div>


{% block scripts %}
<script src="/static/js/local.js"></script>
<script src="/static/js/evidence.js"></script>
{% endblock scripts %}

{% endblock body %}
