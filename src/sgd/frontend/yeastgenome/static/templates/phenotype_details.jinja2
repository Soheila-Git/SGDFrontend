{% extends "global_layout.jinja2" %}

{% block title %}{{ locus.display_name }} Phenotypes{% endblock %}

{% block head %}
    <script>
        var phenotype_details_link = "{{phenotype_details_link}}";
        var phenotype_graph_link = "{{phenotype_graph_link}}";
        var download_table_link = "{{download_table_link}}";
        var download_table_filename = "{{ locus.display_name}}_phenotypes";
        var phenotype_overview = {{phenotype_overview | safe}};
        var display_name = "{{ locus.display_name }}";
        var class_type = "{{ locus.class_type }}";
    </script>
{% endblock %}

{% block body %}

    <div id="center_title" class="row">
        <h2><span class="gene_name">{% if locus.display_name == locus.format_name %}{{ locus.display_name }}{% else %}
            {{ locus.display_name }}/{{ locus.format_name }}{% endif %}</span> Phenotypes <a href="/help/PhenoHelp.html"
                                                                                             name="top" class="help"><i
                class="fa fa-question-circle"></i></a></h2>
    </div>

    <!-- Tabs
    ================================================== -->
    <!-- Includes tabs.html into template -->
    {% include "tabs.jinja2" %}
    <script>document.getElementById("phenotype_tab").id = "current";</script>

    <div class="row">

        <!-- Navbar
        ================================================== -->
        <!-- Includes navbar.html into template -->
        {% include "navbar.jinja2" %}

        <div class="small-12 large-9 columns content-column">

            <script>
                add_navbar_title("<a href='{{ locus.link }}'>{{ locus.display_name }}/{{ locus.format_name }}</a> Phenotypes");
                add_navbar_element("Summary", "summary");
                add_navbar_element("Annotations", "annotations");
                add_navbar_element("Network Visualization", "network");
                add_navbar_element("Resources", "resources");
            </script>

            <!-- Summary
            ================================================== -->
            <section id="summary" data-magellan-destination="summary">
                <div class="page-header">
                    <h1>Summary
                        <a href="#" data-dropdown="summary_info"><i class="fa fa-info-circle"></i></a>

                        <p id="summary_info" class="f-dropdown content medium" data-dropdown-content>
                            Phenotype annotations for a gene are curated single mutant phenotypes that require an
                            observable (e.g., "cell shape"), a qualifier (e.g., "abnormal"), a mutant type (e.g., null),
                            strain background, and a reference. In addition, annotations are classified as classical
                            genetics or high-throughput (e.g., large scale survey, systematic mutation set). Whenever
                            possible, allele information and additional details are provided.
                        </p>
                    </h1>

                    <!-- Includes phenotype_overview.html into template -->
                    {% include "phenotype_overview.jinja2" %}
                </div>
            </section>
            <!-- Annotations
            ================================================== -->
            <section id="annotations" data-magellan-destination="annotations">
                <div class="page-header">
                    <h1>Phenotype Annotations
                        <a href="#" data-dropdown="annotation_info"><i class="fa fa-info-circle"></i></a>

                        <p id="annotation_info" class="f-dropdown content medium" data-dropdown-content>
                            A phenotype is defined as a an observable (e.g., apoptosis) and a qualifier (e.g.,
                            increased). There may be more than one row with the same phenotype if was observed in
                            separate studies or in different conditions, strains, alleles, etc.
                        </p>
                        <span id="phenotype_table_header" class="round secondary label"></span>
                    </h1>
                    <!-- Includes phenotype_table into template -->
                    {% set table_id = "phenotype_table" %}
                    {% include "phenotype_table.jinja2" %}
                </div>
            </section>

            <!-- Network Visualization
            ================================================== -->
            <section id="network" data-magellan-destination="network">
                <div class="page-header">
                    <h1>Network Visualization
                        <a href="#" data-dropdown="network_info"><i class="fa fa-info-circle"></i></a>

                        <p id="network_info" class="f-dropdown content medium" data-dropdown-content>
                            This diagram displays phenotype observables (purple squares) that are shared between the
                            given gene (yellow circle) and other genes (gray circles) based on the number of phenotype
                            observables shared (adjustable using the slider at the bottom).
                        </p>
                    </h1>

                    <div class="panel">
                        <div id="cy" name="cy" style="width:100%;height:700px"></div>
                        <h5>Filter Genes by # of Phenotypes Shared With {{ locus.display_name }}:</h5>

                        <div id="slider" class="noUiSlider" style="width:100%"></div>
                        <div id="slider_ticks"></div>
                        <br>
                    </div>
                </div>
            </section>

            <!-- Resources
            ================================================== -->
            <section id="resources" data-magellan-destination="resources">
                <div class="page-header">
                    <h1>External Resources</h1>
                    <h3>Mutant Strains</h3>

                    <p>
                        {% for url in locus.urls if url.category == 'LOCUS_PHENOTYPE_MUTANT_STRAINS' %}
                            <a href="{{ url.link }}">{{ url.display_name }}</a>{% if not loop.last %} | {% endif %}
                        {% endfor %}
                    </p>

                    <h3>Phenotype Resources</h3>

                    <p>
                        {% for url in locus.urls if url.category == 'LOCUS_PHENOTYPE_PHENOTYPE_RESOURCES' %}
                            <a href="{{ url.link }}">{{ url.display_name }}</a>{% if not loop.last %} | {% endif %}
                        {% endfor %}
                    </p>

                    <h3>Ontology</h3>
                    <a href="{{ ontology_link }}">Yeast Phenotype Ontology</a>
                </div>
            </section>
        </div>
    </div>

    {% block scripts %}
        <script src="/static/js/build/nouislider.min.js"></script>
        <script src="/static/js/build/cytoscape.min.js"></script>
        <script src="/static/js/build/arbor.js"></script>
        <script src="/static/js/cytoscape.js"></script>
        <script src="/static/js/local.js"></script>
        <script src="/static/js/evidence.js"></script>
        <script src="/static/js/phenotype_details.js"></script>
    {% endblock scripts %}

{% endblock body %}
