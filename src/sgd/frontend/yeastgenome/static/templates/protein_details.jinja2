{% extends "global_layout.jinja2" %}

{% block title %}{{ locus.display_name }} Protein{% endblock %}

{% block head %}
<script>
	var protein_domains_link = "{{ protein_domain_details_link }}";
    var protein_domain_graph_link = "{{ protein_domain_graph_link }}";
    var sequence_details_link = "{{ sequence_details_link }}";
    var protein_phosphorylation_details_link = "{{ protein_phosphorylation_details_link }}";
    var ec_number_details_link = "{{ ec_number_details_link }}";
    var protein_experiment_details_link = "{{ protein_experiment_details_link }}";
    var bioentity_details_link = "{{ bioentity_details_link }}";
    var aliases = {{ aliases|safe }};

	var download_table_link = "{{download_table_link}}";
    var download_sequence_link = "{{download_sequence_link}}";
	var analyze_link = "{{analyze_table_link}}";
    var download_network_link = "{{download_network_link}}";

    var domains_table_filename = "{{ locus.display_name }}_domains";
    var alias_table_filename = "{{ locus.display_name }}_external_ids";
    var domain_network_filename = "{{ locus.display_name }}_domain_network";
    var properties_table_filename = "{{ locus.display_name }}_protein_properties";
    var protein_experiment_table_filename = "{{ locus.display_name }}_experimental_data";
    var phosphorylation_table_filename = "{{ locus.display_name }}_phosphorylation";

	var display_name = "{{ locus.display_name }}";
    var format_name = "{{ locus.format_name }}";
	var locus_id = "{{ locus.id }}";

</script>
{% endblock %}

{% block body %}

<div id="center_title" class="row">
	<h2><span class="gene_name">{% if locus.display_name == locus.format_name %}{{ locus.display_name }}{% else %}{{ locus.display_name }}/{{ locus.format_name }}{% endif %}</span> Protein Information</h2>
</div>

<!-- Tabs
================================================== -->
<!-- Includes tabs.html into template -->
{% include "tabs.jinja2" %}
<script>document.getElementById('protein_tab').id = 'current';</script>

<!-- Navbar
================================================== -->
<div class="row">
	
    <!-- Includes navbar.html into template -->
    {% include "navbar.jinja2" %}

    <div class="small-12 large-9 columns content-column">

        <script>
        //Set up navbar
            add_navbar_title('<a href="{{ locus.link }}">{{ locus.display_name }}/{{ locus.format_name }}</a> Protein');
            add_navbar_element('Summary', 'summary');
            add_navbar_element('Experimental Data', 'experiment');
            add_navbar_element('Domains and Classification', 'domain');
            add_navbar_element('Sequence', 'sequence');
            add_navbar_element('External Identifiers', 'external_ids');
            add_navbar_element('Resources', 'resources');
        </script>

        <section id="summary" data-magellan-destination="summary">
        <div class="page-header">
            <h1>Summary
                <a href="#" data-dropdown="summary_info"><i class="fa fa-info-circle"></i></a>

                <div id="summary_info" class="f-dropdown content medium" data-dropdown-content>
                    <p>Protein abundance data, domains, shared domains with other proteins, protein sequence retrieval
                        for
                        various strains, sequence-based physico-chemical proterties, phosphorylation sites, and external
                        identifiers for the protein.</p>
                </div>
            </h1>
            
             <!-- Includes protein_overview.html into template -->
    {% include "protein_overview.jinja2" %}
        </div>
    </section>
   

        <!-- Experimental Data
================================================== -->
        <section id="experiment" data-magellan-destination="experiment">
            <div class="page-header">
                <h1>Experimental Data</h1>
                <!-- Includes domain_table into template -->
                {% set table_id = "protein_experiment_table" %}
                {% include "protein_experiment_table.jinja2" %}
            </div>
        </section>

<!-- Domains
    ================================================== -->
    <section id="domain" data-magellan-destination="domain">
        <div class="page-header">
            <h1>Domains and Classification
                <a href="#" data-dropdown="domain_info"><i class="fa fa-info-circle"></i></a>

                <p id="domain_info" class="f-dropdown content medium" data-dropdown-content>
                    Collection of domains associated with the protein based on various sources, including the
                    protein coordinates for the domain, a domain Description, a Source and corresponding
                    accession ID, and the number of S. cerevisiae genes that share the same domain.
                </p>
                <span id="domain_table_header" class="round secondary label"></span>
            </h1>
            <!-- Includes domain_table into template -->
            {% set table_id = "domain_table" %}
            {% include "domain_table.jinja2" %}

            <div id="domain_locations">
                <h2 class="subheader">Domain Locations
                    <a href="#" data-dropdown="domain_location_info"><i class="fa fa-info-circle"></i></a>

                    <p id="domain_location_info" class="f-dropdown content medium" data-dropdown-content>
                        Visual representation of the locations of the domains within the protein, as listed in
                        the Domains and Classification table. Each row displays the domain(s) derived from a
                        different Source, with domains color-coded according to this Source.
                    </p>

                    <a href="#" data-dropdown="domain_location_help"><i class="fa fa-question-circle"></i></a>

                    <div id="domain_location_help" class="f-dropdown content medium" data-dropdown-content>
                        <p>Scroll over a domain to view its exact coordinates and its Description.</p>
                    </div>
                </h2>
                <div id="domain_chart"></div>
            </div>

            <div id="shared_domains">
                <h2 id="network" class="subheader">Shared Domains
                    <a href="#" data-dropdown="network_help"><i class="fa fa-info-circle"></i></a>

                    <p id="network_help" class="f-dropdown content medium" data-dropdown-content>
                        This diagram displays domains (colored squares) shared between the given protein (yellow circle)
                        and other proteins (gray circles); the domains are color-coded according to their source, as
                        displayed in the Domain Locations table, above.
                    </p>
                </h2>

                {% set network_id = "cy" %}
                {% include "domain_network.jinja2" %}
            </div>
        </div>
    </section>

<!-- Sequence
    ================================================== -->
    <section id="sequence" data-magellan-destination="sequence">
        <div class="page-header">
            <h1>Sequence
                <a href="#" data-dropdown="sequence_info"><i class="fa fa-info-circle"></i></a>

                <p id="sequence_info" class="f-dropdown content medium" data-dropdown-content>
                    Protein sequence for the given gene in S288C and other strains, when available. Amino acids
                    displayed in red represent phosphorylation sites, as curated by PhosphoGRID. More detailed
                    evidence for these phosphorylation sites is presented in the Phosphorylation Sites table,
                    located just below the protein sequence.
                </p>

                <a href="#" data-dropdown="sequence_help"><i class="fa fa-question-circle"></i></a>

                <p id="sequence_help" class="f-dropdown content medium" data-dropdown-content>
                    Use the pull-down menu under "Strain" to select the sequence for a specific strain. The
                    sequence for that strain will appear and can then be downloaded as a .txt file.
                    Phosphorylated residues, as curated by PhosphoGRID, are shown in red if the residues are
                    present in the given strain, and are further detailed in the "Phosphorylation Sites" table
                    below the sequence. Note that a residue marked as phosphorylated has not necessarily been
                    shown to be phosphorylated in a specific strain.
                </p>
            </h1>
            <p id="sequence_section_message" hidden>This locus is not translated into a protein.</p>

            <div id="sequence_section">
                <label><h3>Strain</h3>
                    <select id="strain_selection" class="large-3"></select> - <span id="strain_description"></span>
                </label>

                <pre><blockquote id="sequence_residues"
                                 style="font-family:Monospace; font-size:large"></blockquote></pre>
                <p>* Red amino acids indicate phosphorylation sites. More information below.</p>

                <div class="button-bar">
                    <ul class="button-group radius">
                        <li><a id="sequence_download" class="small button secondary"><i class="fa fa-download"></i>
                            Download (.txt)</a></li>
                    </ul>
                </div>

                <div id="phosphorylation_sites_wrapper">
                    <h2 class="subheader">Phosphorylation Sites
                        <a href="#" data-dropdown="phosphorylation_info"><i class="fa fa-info-circle"></i></a>

                        <p id="phosphorylation_info" class="f-dropdown content medium" data-dropdown-content>
                            Phosphorylation sites for the protein in the selected strain, based on the presence
                            of a residue in the specific strain, as inferred from experimental evidence curated
                            by PhosphoGRID.
                        </p>
                        <span id="phosphorylation_table_header" class="round secondary label"></span>
                    </h2>
                    <!-- Includes phosphorylation_table into template -->
                    {% include "phosphorylation_table.jinja2" %}
                </div>

                <div id="physicochemical_props">
                    <h2 class="subheader">Sequence-Based Physico-chemical Properties
                        <a href="#" data-dropdown="properties_info"><i class="fa fa-info-circle"></i></a>

                        <p id="properties_info" class="f-dropdown content medium" data-dropdown-content>
                            Calculated protein properties, including amino acid composition, length, coding
                            region calculations, and atomic compositionD.
                        </p>

                        <a href="#" data-dropdown="properties_help"><i class="fa fa-question-circle"></i></a>

                        <p id="properties_help" class="f-dropdown content medium" data-dropdown-content>
                            Sort tables using the arrows to the right of a column header to sort by that column;
                            download all properties as a .txt file using the "Download Properties" button.
                        </p>
                    </h2>

                    <div class="row">
                        <div class="small-12 large-6 columns content-column">
                            <h3>Amino Acid Composition</h3>
                            <table class="table table-striped table-bordered table-condensed" id="amino_acid_table"
                                   width="100%">
                                <thead>
                                <tr>
                                    <th>Amino Acid</th>
                                    <th>Frequency</th>
                                    <th>Percentage</th>
                                </tr>
                                </thead>
                            </table>
                            <ul class="button-group radius">
                                <li><a id="protein_properties_download" class="small button secondary"><i
                                        class="fa fa-download"></i> Download Properties (.txt)</a></li>
                            </ul>
                        </div>
                        <div class="small-12 large-6 columns content-column">
                            <h3>Physical Details</h3>
                            <table class="table table-striped table-bordered table-condensed"
                                   id="physical_details_table" width="100%">
                                <tbody>
                                <tr>
                                    <td>Length (a.a):</td>
                                    <td id="length"></td>
                                </tr>
                                <tr>
                                    <td>Molecular Weight (Da):</td>
                                    <td id="molecular_weight"></td>
                                </tr>
                                <tr>
                                    <td>Isoelectric Point (pl):</td>
                                    <td id="pi"></td>
                                </tr>
                                <tr>
                                    <td>Formula:</td>
                                    <td id="formula"></td>
                                </tr>
                                <tr>
                                    <td>Aliphatic Index:</td>
                                    <td id="aliphatic_index"></td>
                                </tr>
                                <tr>
                                    <td>Instability Index:</td>
                                    <td id="instability_index"></td>
                                </tr>
                                </tbody>
                            </table>

                            <h3>Coding Region Translation Calculations</h3>
                            <table class="table table-striped table-bordered table-condensed" id="coding_region_table"
                                   width="100%">
                                <tbody>
                                <tr>
                                    <td>Codon Bias:</td>
                                    <td id="codon_bias"></td>
                                </tr>
                                <tr>
                                    <td>Codon Adaptation Index:</td>
                                    <td id="cai"></td>
                                </tr>
                                <tr>
                                    <td>Frequence of Optimal Codons:</td>
                                    <td id="fop_score"></td>
                                </tr>
                                <tr>
                                    <td>Hydropathicity of Protein:</td>
                                    <td id="gravy_score"></td>
                                </tr>
                                <tr>
                                    <td>Aromaticity Score:</td>
                                    <td id="aromaticity_score"></td>
                                </tr>
                                </tbody>
                            </table>

                            <h3>Extinction Coefficients at 280nm</h3>
                            <table class="table table-striped table-bordered table-condensed"
                                   id="extinction_coeff_table" width="100%">
                                <tbody>
                                <tr>
                                    <td>ALL Cys residues appear as half cystines:</td>
                                    <td id="all_cys_ext_coeff"></td>
                                </tr>
                                <tr>
                                    <td>NO Cys residues appear as half cystines:</td>
                                    <td id="no_cys_ext_coeff"></td>
                                </tr>
                                </tbody>
                            </table>

                            <h3>Atomic Composition</h3>
                            <table class="table table-striped table-bordered table-condensed" id="atomic_table"
                                   width="100%">
                                <thead>
                                <tr>
                                    <th>Atom</th>
                                    <th>Frequency</th>
                                    <th>Percentage</th>
                                </tr>
                                </thead>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

 <!-- External IDs
    ================================================== -->
    <section id="external_ids" data-magellan-destination="external_ids">
        <div class="page-header">
            <h1>External Identifiers
                <a href="#" data-dropdown="external_id_info"><i class="fa fa-info-circle"></i></a>

                <p id="external_id_info" class="f-dropdown content medium" data-dropdown-content>
                    List of external identifiers for the protein from various database sources.
                </p>
                <span id="alias_table_header" class="round secondary label"></span>
            </h1>
            <!-- Includes alias_table into template -->
            {% set table_id = "alias_table" %}
            {% include "alias_table.jinja2" %}
        </div>
    </section>

<!-- Resources
================================================== -->
        <section id="resources" data-magellan-destination="resources">
            <div class="page-header">
                <h1>Resources</h1>
                <h3>Homologs</h3>
                    <p id='homolog_resources_list'>
                        {% for url in locus.urls if url.category == 'LOCUS_PROTEIN_HOMOLOGS'%}
                            <a href="{{ url.link }}" target="_blank">{{ url.display_name }}</a>{% if not loop.last %} | {% endif %}
                        {% endfor %}
                    </p>
                <h3>Protein Databases/Other</h3>
                    <p id='protein_databases_resources_list'>
                        {% for url in locus.urls if url.category == 'LOCUS_PROTEIN_PROTEIN_DATABASES'%}
                            <a href="{{ url.link }}" target="_blank">{{ url.display_name }}</a>{% if not loop.last %} | {% endif %}
                        {% endfor %}
                    </p>
                <h3>Localization</h3>
                    <p id="localization_resources_list">
                        {% for url in locus.urls if url.category == 'LOCUS_PROEIN_LOCALIZATION'%}
                            <a href="{{ url.link }}" target="_blank">{{ url.display_name }}</a>{% if not loop.last %} | {% endif %}
                        {% endfor %}
                    </p>
                <h3>Post-translational Modifications</h3>
                    <p id="modifications_resources_list">
                        {% for url in locus.urls if url.category == 'LOCUS_PROTEIN_MODIFICATIONS'%}
                            <a href="{{ url.link }}" target="_blank">{{ url.display_name }}</a>{% if not loop.last %} | {% endif %}
                        {% endfor %}
                    </p>
            </div>
        </section>

    </div>
</div>

{% block scripts %}
<script src="/static/js/build/nouislider.min.js"></script>
<script src="/static/js/build/cytoscape.min.js"></script>
<script src="/static/js/build/arbor.js"></script>
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript" src="https://www.google.com/jsapi?autoload={'modules':[{'name':'visualization',
       'version':'1','packages':['timeline']}]}"></script>
<script src="/static/js/local.js"></script>
<script src="/static/js/cytoscape.js"></script>
<script src="/static/js/evidence.js"></script>
<script src="/static/js/protein_details.js"></script>
{% endblock scripts %}

{% endblock body %}
